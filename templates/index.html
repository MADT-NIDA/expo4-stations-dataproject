{% extends "base.html" %}

{% block title %}Home{% endblock %}


{% block content %}
  <!-- <section id="" class="light-background">
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
      <ol class="carousel-indicators">
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="4"></li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img class="d-block w-100" src="/static/project/carbonix/Carbon Xchange Pitch Deck Presentation.png" alt="First slide">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/project/lift/MADT7204_Lift.png" alt="Lift">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/project/finsure/logo-image.png" alt="FinSure">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/project/FreshX/image.png" alt="FinSure">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/project/airsniff/image.png" alt="FinSure">
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </a>
    </div>
  </section>

   -->


  <section id="projects" class="services section">

    <!-- Section Title -->
    <div class="container section-title" data-aos="fade-up">
      <!-- <h2>Projects</h2> -->
      <p><span>Check Our</span> <span class="description-title">Projects</span></p>
      <!-- <img src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://expo4.madt.pro/#projects" alt="QR Code" width="200"/> -->
    </div><!-- End Section Title -->

    <div class="container">

      <div class="row gy-4">

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
          <div class="service-item position-relative">
            <div class="icon">
              <img src="/static/logo/Carbonix.png" alt="icon" style="width: 4rem; height: 4rem; background: white;" />
            </div>
            <a href="/projects/carbonix" class="stretched-link">
              <h3>Carbonix</h3>
            </a>
            <p>The Carbon Credit Exchange serves as a comprehensive digital marketplace, specializing in carbon credit trading, environmental, social, and governance (ESG) consulting, and sustainability management solutions. </p>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
          <div class="service-item position-relative">
            <div class="icon">
              <img src="/static/logo/freshX.png" alt="icon" style="width: 4rem; height: 4rem;" />
            </div>
            <a href="/projects/freshx" class="stretched-link">
              <h3>FreshX</h3>
            </a>
            <p>
              AI-powered air purifier rental platform that offers affordable, high-quality air solutions for healthier living
            </p>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="400">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-shield-check"></i>
            </div>
            <a href="/projects/finsure" class="stretched-link">
              <h3>FinSure</h3>
            </a>
            <p>A microinsurance platform that protects workersâ€™ income during PM2.5 using real-time AQI and AI pricing.</p>
            <!-- <a href="#" class="stretched-link"></a> -->
          </div>
        </div><!-- End Service Item -->

        
        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="300">
          <div class="service-item position-relative">
            <div class="icon">
              <img src="/static/logo/lift.png" alt="icon" style="width: 4rem; height: 4rem;" />
            </div>
            <a href="/projects/lift" class="stretched-link">
              <h3>Lift</h3>
            </a>
            <p>Eco-friendly ride-sharing platform matching passengers and splitting fares in real-time
          </div>
        </div><!-- End Service Item -->


        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="500">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-tree-fill"></i>
            </div>
            <a href="/projects/greenbridge" class="stretched-link">
              <h3>Green Bridge</h3>
            </a>
            <p>Green Bridge is a digital platform that connects Big Firms and SMEs to accelerate carbon reduction toward Net-Zero. </p>
            <!-- <a href="#" class="stretched-link"></a> -->
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="500">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-wind"></i>
            </div>
            <a href="/projects/airsniff" class="stretched-link">
              <h3>AirSniff</h3>
            </a>
            <p>A smart sensor system that detects heat and smoke early to prevent fires and reduce air pollution in urban communities.</p>
            <!-- <a href="#" class="stretched-link"></a> -->
          </div>
        </div>
        <!-- End Service Item -->

      </div>

    </div>

  </section><!-- /Services Section -->

  <button id="chat-widget-button">ðŸ’¬</button>
  <div id="chat-widget-container">
      <div id="chat-widget-header">
          <span>Chat</span>
          <button onclick="closeChatWidget()">âœ–</button>
      </div>
      <div id="chat-widget-body">
          <p style="margin-bottom: 20px;"><strong>Hi ðŸ‘‹, how can we help?</strong></p>
      </div>
      <div id="chat-widget-footer">
          <input type="text" id="chat-widget-input" placeholder="Type your message here...">
          <button id="chat-widget-send">Send</button>
      </div>
  </div>

{% endblock %}

{% block footer %}
<script>
  
  document.addEventListener('DOMContentLoaded', function () {

    function getsessionId() {
        let sessionId = sessionStorage.getItem("sessionId");
        if (!sessionId) {
            const sessionId = crypto.randomUUID();
            sessionStorage.setItem("sessionId", sessionId);
        }
        return sessionId;
    }
    var sessionId = getsessionId(); 


    var el = document.querySelector('#carouselExampleIndicators');
    if (el) {
      new bootstrap.Carousel(el, {
        interval: 5000, // 0.1 à¸§à¸´à¸™à¸²à¸—à¸µ
        ride: 'carousel'
      });
    };

    fetch("/records/scan", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        session_id: sessionId,
        project: ""
      })
    })
    .then(response => {
      if (!response.ok) {
        throw new Error("Request failed with status " + response.status);
      }
      return response.json();
    })
    .then(data => {
      console.log("Server response:", data);
    })
    .catch(error => {
      console.error("Error posting to /records/scan:", error);
    });

  });



</script>

    <script>
        window.ChatWidgetConfig = {
            webhook: {
                url: 'https://n8n.madt.pro/webhook/aa25537e-22a7-4c62-b520-b510920098c0/chat',
                route: 'general'
            },
            style: {
                primaryColor: '#854fff',
                secondaryColor: '#6b3fd4',
                position: 'right',
                backgroundColor: '#ffffff',
                fontColor: '#333333'
            }
        };

        // Function to generate or retrieve a unique chat ID
        
        // Show chat widget and hide bubble
        document.getElementById("chat-widget-button").addEventListener("click", function() {
            document.getElementById("chat-widget-container").style.display = "flex";
            document.getElementById("chat-widget-button").style.display = "none";
        });

        // Close chat widget and show bubble
        function closeChatWidget() {
            document.getElementById("chat-widget-container").style.display = "none";
            document.getElementById("chat-widget-button").style.display = "flex";
        }

        // Send message to n8n webhook
        document.getElementById("chat-widget-send").addEventListener("click", function() {
            let message = document.getElementById("chat-widget-input").value;
            if (message.trim() === "") return;

            let chatBody = document.getElementById("chat-widget-body");
            let newMessage = document.createElement("p");
            newMessage.textContent = message;
            newMessage.style.color = "#333";
            newMessage.style.background = "#f1f1f1";
            chatBody.appendChild(newMessage);

            // Retrieve the session chat ID

            function getsessionId() {
                let sessionId = sessionStorage.getItem("sessionId");
                if (!sessionId) {
                    const sessionId = crypto.randomUUID();
                    sessionStorage.setItem("sessionId", sessionId);
                }
                return sessionId;
            }
            

            fetch(window.ChatWidgetConfig.webhook.url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Basic " + btoa("admin:asdf")
                },
                body: JSON.stringify({
                    sessionId: getsessionId(),  // Attach chat ID for memory tracking
                    chatInput: message,
                    project: '',
                    route: window.ChatWidgetConfig.webhook.route
                })
            })
            .then(response => response.json())
            .then(data => {
                let botMessage = document.createElement("p");
                // botMessage.innerHTML = data.output || "Sorry, I couldn't understand that.";
                botMessage.innerHTML = (data.output || "Sorry, I couldn't understand that.").replace(/\n/g, "<br>");
                botMessage.style.color = "#fff";
                botMessage.style.background = "#854fff";
                botMessage.style.marginTop = "10px";
                chatBody.appendChild(botMessage);
            })
            .catch(error => console.error("Error:", error));

            document.getElementById("chat-widget-input").value = "";
        });
    </script>

{% endblock %}
