{% extends "base.html" %}

{% block title %}Home{% endblock %}


{% block content %}
  <section id="" class="light-background">
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
      <ol class="carousel-indicators">
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"></li>
        <li data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"></li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <img class="d-block w-100" src="/static/project/carbonix/Carbon Xchange Pitch Deck Presentation.png" alt="First slide">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/project/lift/MADT7204_Lift.png" alt="Lift">
        </div>
        <div class="carousel-item">
          <img class="d-block w-100" src="/static/assets/img/masonry-portfolio/masonry-portfolio-2.jpg" alt="Third slide">
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </a>
    </div>
  </section>

  


  <section id="projects" class="services section">

    <!-- Section Title -->
    <div class="container section-title" data-aos="fade-up">
      <h2>Projects</h2>
      <p><span>Check Our</span> <span class="description-title">Projects</span></p>
      <!-- <img src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=https://expo4.madt.pro/#projects" alt="QR Code" width="200"/> -->
    </div><!-- End Section Title -->

    <div class="container">

      <div class="row gy-4">

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="100">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-activity"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>Carbonix</h3>
            </a>
            <p>Carbonix Desc</p>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="200">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-broadcast"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>FreashX</h3>
            </a>
            <p>
              FreashX Desc
            </p>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="300">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-easel"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>Lift</h3>
            </a>
            <p>Lift Desc</p>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="400">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-bounding-box-circles"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>Asperiores Commodit</h3>
            </a>
            <p>Non et temporibus minus omnis sed dolor esse consequatur. Cupiditate sed error ea fuga sit provident adipisci neque.</p>
            <a href="#" class="stretched-link"></a>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="500">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-calendar4-week"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>Velit Doloremque</h3>
            </a>
            <p>Cumque et suscipit saepe. Est maiores autem enim facilis ut aut ipsam corporis aut. Sed animi at autem alias eius labore.</p>
            <a href="#" class="stretched-link"></a>
          </div>
        </div><!-- End Service Item -->

        <div class="col-lg-4 col-md-6" data-aos="fade-up" data-aos-delay="600">
          <div class="service-item position-relative">
            <div class="icon">
              <i class="bi bi-chat-square-text"></i>
            </div>
            <a href="#" class="stretched-link">
              <h3>Dolori Architecto</h3>
            </a>
            <p>Hic molestias ea quibusdam eos. Fugiat enim doloremque aut neque non et debitis iure. Corrupti recusandae ducimus enim.</p>
            <a href="#" class="stretched-link"></a>
          </div>
        </div><!-- End Service Item -->

      </div>

    </div>

  </section><!-- /Services Section -->

  <button id="chat-widget-button">ðŸ’¬</button>
  <div id="chat-widget-container">
      <div id="chat-widget-header">
          <span>Chat</span>
          <button onclick="closeChatWidget()">âœ–</button>
      </div>
      <div id="chat-widget-body">
          <p style="margin-bottom: 20px;"><strong>Hi ðŸ‘‹, how can we help?</strong></p>
      </div>
      <div id="chat-widget-footer">
          <input type="text" id="chat-widget-input" placeholder="Type your message here...">
          <button id="chat-widget-send">Send</button>
      </div>
  </div>

{% endblock %}

{% block footer %}
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const el = document.querySelector('#carouselExampleIndicators');
    if (el) {
      new bootstrap.Carousel(el, {
        interval: 5000, // 0.1 à¸§à¸´à¸™à¸²à¸—à¸µ
        ride: 'carousel'
      });
    }
  });
</script>

    <script>
        window.ChatWidgetConfig = {
            webhook: {
                url: 'http://34.143.247.40:5678/webhook/68282fbb-afad-437d-88ed-2c1476bb457b/chat',
                route: 'general'
            },
            style: {
                primaryColor: '#854fff',
                secondaryColor: '#6b3fd4',
                position: 'right',
                backgroundColor: '#ffffff',
                fontColor: '#333333'
            }
        };

        // Function to generate or retrieve a unique chat ID
        function getsessionId() {
            let sessionId = sessionStorage.getItem("sessionId");
            if (!sessionId) {
                sessionId = "chat_" + Math.random().toString(36).substr(2, 9); // Unique ID
                sessionStorage.setItem("sessionId", sessionId);
            }
            return sessionId;
        }

        // Show chat widget and hide bubble
        document.getElementById("chat-widget-button").addEventListener("click", function() {
            document.getElementById("chat-widget-container").style.display = "flex";
            document.getElementById("chat-widget-button").style.display = "none";
        });

        // Close chat widget and show bubble
        function closeChatWidget() {
            document.getElementById("chat-widget-container").style.display = "none";
            document.getElementById("chat-widget-button").style.display = "flex";
        }

        // Send message to n8n webhook
        document.getElementById("chat-widget-send").addEventListener("click", function() {
            let message = document.getElementById("chat-widget-input").value;
            if (message.trim() === "") return;

            let chatBody = document.getElementById("chat-widget-body");
            let newMessage = document.createElement("p");
            newMessage.textContent = message;
            newMessage.style.color = "#333";
            newMessage.style.background = "#f1f1f1";
            chatBody.appendChild(newMessage);

            let sessionId = getsessionId(); // Retrieve the session chat ID

            fetch(window.ChatWidgetConfig.webhook.url, {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                    "Authorization": "Basic " + btoa("chat:asdf")
                },
                body: JSON.stringify({
                    sessionId: sessionId,  // Attach chat ID for memory tracking
                    chatInput: message,
                    route: window.ChatWidgetConfig.webhook.route
                })
            })
            .then(response => response.json())
            .then(data => {
                let botMessage = document.createElement("p");
                botMessage.innerHTML = data.output || "Sorry, I couldn't understand that.";
                botMessage.style.color = "#fff";
                botMessage.style.background = "#854fff";
                botMessage.style.marginTop = "10px";
                chatBody.appendChild(botMessage);
            })
            .catch(error => console.error("Error:", error));

            document.getElementById("chat-widget-input").value = "";
        });
    </script>

{% endblock %}
